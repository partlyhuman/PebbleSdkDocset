<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Pebble SDK: AppMessage</title>
  <link href='bootstrap.css' media='screen' rel='stylesheet' type='text/css' />
  <link href='pebble-developer.css' media='screen' rel='stylesheet' type='text/css' />
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
  <link href="stylesheet.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30638158-4']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
</head>
<body>
  <div id="top" ><!-- do not remove this div, it is closed by doxygen! -->
    <div class="navbar navbar-inverse ">
      <div class="navbar-inner">
        <div class="container">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li><a class="first" href="#"><span></span></a></li>
              <li><a href="http://developer.getpebble.com/">Develop for Pebble</a></li>
            </ul>
            <ul class="nav pull-right">
              <li class="doc-nav-searchbox">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</li>
              <li><a href="http://forums.getpebble.com/">Forum</a></li>
              <li><a href="http://developer.getpebble.com/2/api-reference/modules.html">API Documentation</a></li>
              <li><a href="http://developer.getpebble.com/2/">Guides</a></li>
              <li><a href="http://developer.getpebble.com/blog/">Developer Blog</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___app_message.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AppMessage<div class="ingroups"><a class="el" href="group___foundation.html">Foundation</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Bi-directional communication between phone apps and Pebble watchapps. </p>
<p>AppMessage is a bi-directional messaging subsystem that enables communication between phone apps and Pebble watchapps. This is accomplished by allowing phone and watchapps to exchange arbitrary sets of key/value pairs. The key/value pairs are stored in the form of a Dictionary, the layout of which is left for the application developer to define.</p>
<p>AppMessage implements a push-oriented messaging protocol, enabling your app to call functions and methods to push messages from Pebble to phone and vice versa. The protocol is symmetric: both Pebble and the phone can send messages. All messages are acknowledged. In this context, there is no client-server model, as such.</p>
<p>During the sending phase, one side initiates the communication by transferring a dictionary over the air. The other side then receives this message and is given an opportunity to perform actions on that data. As soon as possible, the other side is expected to reply to the message with a simple acknowledgment that the message was received successfully.</p>
<p>PebbleKit JavaScript provides you with a set of standard JavaScript APIs that let your app receive messages from the watch, make HTTP requests, and send new messages to the watch. AppMessage APIs are used to send and receive data. A Pebble watchapp can use the resources of the connected phone to fetch information from web services, send information to web APIs, or store login credentials. On the JavaScript side, you communicate with Pebble via a Pebble object exposed in the namespace.</p>
<p>Messages always need to get either ACKnowledged or "NACK'ed," that is, not acknowledged. If not, messages will result in a time-out failure. The AppMessage subsystem takes care of this implicitly. In the phone libraries, this step is a bit more explicit.</p>
<p>The Pebble watch interfaces make a distinction between the Inbox and the Outbox calls. The Inbox receives messages from the phone on the watch; the Outbox sends messages from the watch to the phone. These two buffers can be managed separately.</p>
<h4>Warning</h4>
<p>A critical constraint of AppMessage is that messages are limited in size. An ingoing (outgoing) message larger than the inbox (outbox) will not be transmitted and will generate an error. You can choose your inbox and outbox size when you call <a class="el" href="group___app_message.html#ga26735aa7eb22ab58bd7496e673d03155" title="Open AppMessage to transfers. ">app_message_open()</a>.</p>
<p>Pebble SDK provides a static minimum guaranteed size (APP_MESSAGE_INBOX_SIZE_MINIMUM and APP_MESSAGE_OUTBOX_SIZE_MINIMUM). Requesting a buffer of the minimum guaranteed size (or smaller) is always guaranteed to succeed on all Pebbles in this SDK version or higher, and with every phone.</p>
<p>In some context, Pebble might be able to provide your application with larger inbox/outbox. You can call <a class="el" href="group___app_message.html#gad544294c297f3d1941bd94b6b396a24b" title="Programatically determine the inbox size maximum in the current configuration. ">app_message_inbox_size_maximum()</a> and <a class="el" href="group___app_message.html#gaa8161491da4b16dde64be8754cfde815" title="Programatically determine the outbox size maximum in the current configuration. ">app_message_outbox_size_maximum()</a> in your code to get the largest possible value you can use.</p>
<p>To always get the largest buffer available, follow this best practice:</p>
<p>app_message_open(<a class="el" href="group___app_message.html#gad544294c297f3d1941bd94b6b396a24b" title="Programatically determine the inbox size maximum in the current configuration. ">app_message_inbox_size_maximum()</a>, <a class="el" href="group___app_message.html#gaa8161491da4b16dde64be8754cfde815" title="Programatically determine the outbox size maximum in the current configuration. ">app_message_outbox_size_maximum()</a>)</p>
<p>AppMessage uses your application heap space. That means that the sizes you pick for the AppMessage inbox and outbox buffers are important in optimizing your app’s performance. The more you use for AppMessage, the less space you’ll have for the rest of your app.</p>
<p>To register callbacks, you should call <a class="el" href="group___app_message.html#ga9ab844c63d926f0e8f708a171b3838d3" title="Registers a function that will be called after any Inbox message is received successfully. ">app_message_register_inbox_received()</a>, <a class="el" href="group___app_message.html#gad15eeddef5ffa5ea0185eb734c0fbe9d" title="Registers a function that will be called after any Inbox message is received but dropped by the syste...">app_message_register_inbox_dropped()</a>, <a class="el" href="group___app_message.html#gae7cbb364b6e932c4bfd1ae89ecca87f9" title="Registers a function that will be called after any Outbox message is sent and an ACK reply occurs in ...">app_message_register_outbox_sent()</a>, <a class="el" href="group___app_message.html#ga73c134254ff2b17d3c57c7d019e79323" title="Registers a function that will be called after any Outbox message is not sent with a timely ACK reply...">app_message_register_outbox_failed()</a>.</p>
<p>Pebble recommends that you call them before <a class="el" href="group___app_message.html#ga26735aa7eb22ab58bd7496e673d03155" title="Open AppMessage to transfers. ">app_message_open()</a> to ensure you do not miss a message arriving between starting AppMessage and registering the callback. You can set a context that will be passed to all the callbacks with <a class="el" href="group___app_message.html#gab6d67168d6bed587d5e0c92cd3a54ba6" title="Sets the context that will be passed to all AppMessage callbacks. ">app_message_set_context()</a>.</p>
<p>In circumstances that may not be ideal, when using AppMessage several types of errors may occur. For example:</p>
<ul>
<li>The send can’t start because the system state won't allow for a success. Several reasons you're unable to perform a send: A send() is already occurring (only one is possible at a time) or Bluetooth is not enabled or connected.</li>
<li>The send and receive occur, but the receiver can’t accept the message. For instance, there is no app that receives such a message.</li>
<li>The send occurs, but the receiver either does not actually receive the message or can’t handle it in a timely fashion.</li>
<li>In the case of a dropped message, the phone sends a message to the watchapp, while there is still an unprocessed message in the Inbox.</li>
</ul>
<p>Other errors are possible and described by AppMessageResult. A client of the AppMessage interface should use the result codes to be more robust in the face of communication problems either in the field or while debugging.</p>
<p>Refer to the<a href="http://developer.getpebble.com/2/guides/app-phone-communication.html">Integrating Pebble Watchapps with Phone Apps in Pebble Developer Guide</a>
 for a conceptual overview and code usage.</p>
<p>For code examples, refer to the SDK Examples that directly use App Message. These include:</p>
<ul>
<li>Examples/todolist-demo</li>
<li>Examples/pebblekit-js/quotes</li>
<li>Examples/weather-demo </li>
</ul>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga4794243c5779d5e861f964b61e0a7652"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void app_message_deregister_callbacks </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deregisters all callbacks and their context. </p>

</div>
</div>
<a class="anchor" id="gabb31148adaf227f338b011b8da7b61c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* app_message_get_context </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the context that will be passed to all AppMessage callbacks. </p>
<dl class="section return"><dt>Returns</dt><dd>The current context on record. </dd></dl>

</div>
</div>
<a class="anchor" id="gad544294c297f3d1941bd94b6b396a24b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___standard_c.html#gad53b3f685c3f3153f35ec87ea6f349d1">uint32_t</a> app_message_inbox_size_maximum </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Programatically determine the inbox size maximum in the current configuration. </p>
<dl class="section return"><dt>Returns</dt><dd>The inbox size maximum on this firmware.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___app_message.html#ga8a213339bca4388cf17c3f4c4b2e11fd" title="As long as the firmware maintains its current major version, inboxes of this size or smaller will be ...">APP_MESSAGE_INBOX_SIZE_MINIMUM</a> </dd>
<dd>
<a class="el" href="group___app_message.html#gaa8161491da4b16dde64be8754cfde815" title="Programatically determine the outbox size maximum in the current configuration. ">app_message_outbox_size_maximum()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga26735aa7eb22ab58bd7496e673d03155"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___app_message.html#ga695a78c926b20edbb14d7faf5a78c29e">AppMessageResult</a> app_message_open </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group___standard_c.html#gad53b3f685c3f3153f35ec87ea6f349d1">uint32_t</a>&#160;</td>
          <td class="paramname"><em>size_inbound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group___standard_c.html#gad53b3f685c3f3153f35ec87ea6f349d1">uint32_t</a>&#160;</td>
          <td class="paramname"><em>size_outbound</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open AppMessage to transfers. </p>
<p>Use <a class="el" href="group___dictionary.html#gad31424a83643adbfd9e84c4bd37e4627">dict_calc_buffer_size_from_tuplets()</a> or <a class="el" href="group___dictionary.html#ga0551d069624fb5bfc066fecfa4153bde">dict_calc_buffer_size()</a> to estimate the size you need.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">size_inbound</td><td>The required size for the Inbox buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size_outbound</td><td>The required size for the Outbox buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A result code such as <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29ea12a6ea49b151222e76cf4b99b7c0c4cc">APP_MSG_OK</a> or <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29ead1cce21da2d8b46e305f9550a7384238">APP_MSG_OUT_OF_MEMORY</a>.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>It is recommended that if the Inbox will be used, that at least the Inbox callbacks should be registered before this call. Otherwise it is possible for an Inbox message to be NACK'ed without being seen by the application. </dd></dl>

</div>
</div>
<a class="anchor" id="ga7715e322ec2a7a49bf66aa63353190fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___app_message.html#ga695a78c926b20edbb14d7faf5a78c29e">AppMessageResult</a> app_message_outbox_begin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___dictionary.html#struct_dictionary_iterator">DictionaryIterator</a> **&#160;</td>
          <td class="paramname"><em>iterator</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Begin writing to the Outbox's Dictionary buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">iterator</td><td>Location to write the <a class="el" href="group___dictionary.html#struct_dictionary_iterator" title="An iterator can be used to iterate over the key/value tuples in an existing dictionary, using dict_read_begin_from_buffer(), dict_read_first() and dict_read_next(). An iterator can also be used to append key/value tuples to a dictionary, for example using dict_write_data() or dict_write_cstring(). ">DictionaryIterator</a> pointer. This will be NULL on failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A result code, including but not limited to <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29ea12a6ea49b151222e76cf4b99b7c0c4cc">APP_MSG_OK</a>, <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29eadfb91bdd9c369cc2eb00e019b4cf3846">APP_MSG_INVALID_ARGS</a> or <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29eaad6af2baa488efedd56b17f0ed1e8339">APP_MSG_BUSY</a>.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>After a successful call, one can add values to the dictionary using functions like <a class="el" href="group___dictionary.html#ga30091feef740732d5d6bc3cf2312642a">dict_write_data()</a> and friends.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___dictionary.html" title="Data serialization utilities. ">Dictionary</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga54169009d1ad008ea8e4f66005ce9cfc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___app_message.html#ga695a78c926b20edbb14d7faf5a78c29e">AppMessageResult</a> app_message_outbox_send </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends the outbound dictionary. </p>
<dl class="section return"><dt>Returns</dt><dd>A result code, including but not limited to <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29ea12a6ea49b151222e76cf4b99b7c0c4cc">APP_MSG_OK</a> or <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29eaad6af2baa488efedd56b17f0ed1e8339">APP_MSG_BUSY</a>. The APP_MSG_OK code does not mean that the message was sent successfully, but only that the start of processing was successful. Since this call is asynchronous, callbacks provide the final result instead.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___app_message.html#ga3b8cde26c0744516c8acca1b3a3638af" title="Called after an outbound message has been sent and the reply has been received. ">AppMessageOutboxSent</a> </dd>
<dd>
<a class="el" href="group___app_message.html#gab360cbc2497e5f2bbfe2aa137a646c6a" title="Called after an outbound message has not been sent successfully. ">AppMessageOutboxFailed</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gaa8161491da4b16dde64be8754cfde815"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___standard_c.html#gad53b3f685c3f3153f35ec87ea6f349d1">uint32_t</a> app_message_outbox_size_maximum </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Programatically determine the outbox size maximum in the current configuration. </p>
<dl class="section return"><dt>Returns</dt><dd>The outbox size maximum on this firmware.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___app_message.html#ga6fe648fbe225cda63583342bb2305187" title="As long as the firmware maintains its current major version, outboxes of this size or smaller will be...">APP_MESSAGE_OUTBOX_SIZE_MINIMUM</a> </dd>
<dd>
<a class="el" href="group___app_message.html#gad544294c297f3d1941bd94b6b396a24b" title="Programatically determine the inbox size maximum in the current configuration. ">app_message_inbox_size_maximum()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gad15eeddef5ffa5ea0185eb734c0fbe9d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___app_message.html#gaebc89fb84b4199c8eb5c4a07112f1867">AppMessageInboxDropped</a> app_message_register_inbox_dropped </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___app_message.html#gaebc89fb84b4199c8eb5c4a07112f1867">AppMessageInboxDropped</a>&#160;</td>
          <td class="paramname"><em>dropped_callback</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a function that will be called after any Inbox message is received but dropped by the system. </p>
<p>Only one callback may be registered at a time. Each subsequent call to this function will replace the previous callback. The callback is optional; setting it to NULL will deregister the current callback and no function will be called anymore.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dropped_callback</td><td>The callback that will be called going forward; NULL to not have a callback.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The previous callback (or NULL) that was on record. </dd></dl>

</div>
</div>
<a class="anchor" id="ga9ab844c63d926f0e8f708a171b3838d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___app_message.html#ga96afe3dc428a27239758f73b3cb84d9c">AppMessageInboxReceived</a> app_message_register_inbox_received </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___app_message.html#ga96afe3dc428a27239758f73b3cb84d9c">AppMessageInboxReceived</a>&#160;</td>
          <td class="paramname"><em>received_callback</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a function that will be called after any Inbox message is received successfully. </p>
<p>Only one callback may be registered at a time. Each subsequent call to this function will replace the previous callback. The callback is optional; setting it to NULL will deregister the current callback and no function will be called anymore.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">received_callback</td><td>The callback that will be called going forward; NULL to not have a callback.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The previous callback (or NULL) that was on record. </dd></dl>

</div>
</div>
<a class="anchor" id="ga73c134254ff2b17d3c57c7d019e79323"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___app_message.html#gab360cbc2497e5f2bbfe2aa137a646c6a">AppMessageOutboxFailed</a> app_message_register_outbox_failed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___app_message.html#gab360cbc2497e5f2bbfe2aa137a646c6a">AppMessageOutboxFailed</a>&#160;</td>
          <td class="paramname"><em>failed_callback</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a function that will be called after any Outbox message is not sent with a timely ACK reply. The call to <a class="el" href="group___app_message.html#ga54169009d1ad008ea8e4f66005ce9cfc">app_message_outbox_send()</a> must have succeeded. </p>
<p>Only one callback may be registered at a time. Each subsequent call to this function will replace the previous callback. The callback is optional; setting it to NULL will deregister the current callback and no function will be called anymore.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">failed_callback</td><td>The callback that will be called going forward; NULL to not have a callback.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The previous callback (or NULL) that was on record. </dd></dl>

</div>
</div>
<a class="anchor" id="gae7cbb364b6e932c4bfd1ae89ecca87f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___app_message.html#ga3b8cde26c0744516c8acca1b3a3638af">AppMessageOutboxSent</a> app_message_register_outbox_sent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___app_message.html#ga3b8cde26c0744516c8acca1b3a3638af">AppMessageOutboxSent</a>&#160;</td>
          <td class="paramname"><em>sent_callback</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a function that will be called after any Outbox message is sent and an ACK reply occurs in a timely fashion. </p>
<p>Only one callback may be registered at a time. Each subsequent call to this function will replace the previous callback. The callback is optional; setting it to NULL will deregister the current callback and no function will be called anymore.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sent_callback</td><td>The callback that will be called going forward; NULL to not have a callback.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The previous callback (or NULL) that was on record. </dd></dl>

</div>
</div>
<a class="anchor" id="gab6d67168d6bed587d5e0c92cd3a54ba6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* app_message_set_context </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>context</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the context that will be passed to all AppMessage callbacks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>The context that will be passed to all AppMessage callbacks.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The previous context that was on record. </dd></dl>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="gaebc89fb84b4199c8eb5c4a07112f1867"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* AppMessageInboxDropped)(<a class="el" href="group___app_message.html#ga695a78c926b20edbb14d7faf5a78c29e">AppMessageResult</a> reason, void *context)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called after an incoming message is dropped. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">result</td><td>The reason why the message was dropped. Some possibilities include <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29eaad6af2baa488efedd56b17f0ed1e8339">APP_MSG_BUSY</a> and <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29eaf2eb603be26c295d0a16433564a72598">APP_MSG_BUFFER_OVERFLOW</a>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>Pointer to application data as specified when registering the callback.</td></tr>
  </table>
  </dd>
</dl>
<p>Note that you can call <a class="el" href="group___app_message.html#ga7715e322ec2a7a49bf66aa63353190fd" title="Begin writing to the Outbox&#39;s Dictionary buffer. ">app_message_outbox_begin()</a> from this handler to prepare a new message. This will invalidate the previous dictionary iterator; do not use it after calling <a class="el" href="group___app_message.html#ga7715e322ec2a7a49bf66aa63353190fd" title="Begin writing to the Outbox&#39;s Dictionary buffer. ">app_message_outbox_begin()</a>. </p>

</div>
</div>
<a class="anchor" id="ga96afe3dc428a27239758f73b3cb84d9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* AppMessageInboxReceived)(<a class="el" href="group___dictionary.html#struct_dictionary_iterator">DictionaryIterator</a> *iterator, void *context)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called after an incoming message is received. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iterator</td><td>The dictionary iterator to the received message. Never NULL. Note that the iterator cannot be modified or saved off. The library may need to re-use the buffered space where this message is supplied. Returning from the callback indicates to the library that the received message contents are no longer needed or have already been externalized outside its buffering space and iterator.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>Pointer to application data as specified when registering the callback. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gab360cbc2497e5f2bbfe2aa137a646c6a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* AppMessageOutboxFailed)(<a class="el" href="group___dictionary.html#struct_dictionary_iterator">DictionaryIterator</a> *iterator, <a class="el" href="group___app_message.html#ga695a78c926b20edbb14d7faf5a78c29e">AppMessageResult</a> reason, void *context)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called after an outbound message has not been sent successfully. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iterator</td><td>The dictionary iterator to the sent message. The iterator will be in the final state that was sent. Note that the iterator cannot be modified or saved off as the library will re-open the dictionary with dict_begin() after this callback returns.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">result</td><td>The result of the operation. Some possibilities for the value include <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29ea4a03bcc21fc33a6acc7d73188b2b4b21">APP_MSG_SEND_TIMEOUT</a>, <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29eadba700a7db67d4238d24e7379b69fba3">APP_MSG_SEND_REJECTED</a>, <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29ea8dda18d5302ef6b07aa83985e91b54b7">APP_MSG_NOT_CONNECTED</a>, <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29ea38e78da25eed665c85368df213ed8088">APP_MSG_APP_NOT_RUNNING</a>, and the combination <code>(APP_MSG_NOT_CONNECTED | APP_MSG_APP_NOT_RUNNING)</code>.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">context</td><td>Pointer to application data as specified when registering the callback.</td></tr>
  </table>
  </dd>
</dl>
<p>Note that you can call <a class="el" href="group___app_message.html#ga7715e322ec2a7a49bf66aa63353190fd" title="Begin writing to the Outbox&#39;s Dictionary buffer. ">app_message_outbox_begin()</a> from this handler to prepare a new message. This will invalidate the previous dictionary iterator; do not use it after calling <a class="el" href="group___app_message.html#ga7715e322ec2a7a49bf66aa63353190fd" title="Begin writing to the Outbox&#39;s Dictionary buffer. ">app_message_outbox_begin()</a>. </p>

</div>
</div>
<a class="anchor" id="ga3b8cde26c0744516c8acca1b3a3638af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* AppMessageOutboxSent)(<a class="el" href="group___dictionary.html#struct_dictionary_iterator">DictionaryIterator</a> *iterator, void *context)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called after an outbound message has been sent and the reply has been received. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iterator</td><td>The dictionary iterator to the sent message. The iterator will be in the final state that was sent. Note that the iterator cannot be modified or saved off as the library will re-open the dictionary with dict_begin() after this callback returns.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>Pointer to application data as specified when registering the callback. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="ga695a78c926b20edbb14d7faf5a78c29e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group___app_message.html#ga695a78c926b20edbb14d7faf5a78c29e">AppMessageResult</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>AppMessage result codes. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29ea12a6ea49b151222e76cf4b99b7c0c4cc"></a>APP_MSG_OK</em>&nbsp;</td><td class="fielddoc">
<p>All good, operation was successful. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29ea4a03bcc21fc33a6acc7d73188b2b4b21"></a>APP_MSG_SEND_TIMEOUT</em>&nbsp;</td><td class="fielddoc">
<p>The other end did not confirm receiving the sent data with an (n)ack in time. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29eadba700a7db67d4238d24e7379b69fba3"></a>APP_MSG_SEND_REJECTED</em>&nbsp;</td><td class="fielddoc">
<p>The other end rejected the sent data, with a "nack" reply. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29ea8dda18d5302ef6b07aa83985e91b54b7"></a>APP_MSG_NOT_CONNECTED</em>&nbsp;</td><td class="fielddoc">
<p>The other end was not connected. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29ea38e78da25eed665c85368df213ed8088"></a>APP_MSG_APP_NOT_RUNNING</em>&nbsp;</td><td class="fielddoc">
<p>The local application was not running. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29eadfb91bdd9c369cc2eb00e019b4cf3846"></a>APP_MSG_INVALID_ARGS</em>&nbsp;</td><td class="fielddoc">
<p>The function was called with invalid arguments. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29eaad6af2baa488efedd56b17f0ed1e8339"></a>APP_MSG_BUSY</em>&nbsp;</td><td class="fielddoc">
<p>There are pending (in or outbound) messages that need to be processed first before new ones can be received or sent. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29eaf2eb603be26c295d0a16433564a72598"></a>APP_MSG_BUFFER_OVERFLOW</em>&nbsp;</td><td class="fielddoc">
<p>The buffer was too small to contain the incoming message. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29ea9ea88c5f059e1aee4010fee576d766bd"></a>APP_MSG_ALREADY_RELEASED</em>&nbsp;</td><td class="fielddoc">
<p>The resource had already been released. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29ea1655968e4f04aa0b357acc4605dcff64"></a>APP_MSG_CALLBACK_ALREADY_REGISTERED</em>&nbsp;</td><td class="fielddoc">
<p>The callback node was already registered, or its ListNode has not been initialized. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29eaf423093b0f84bca4495e227bdcd207bd"></a>APP_MSG_CALLBACK_NOT_REGISTERED</em>&nbsp;</td><td class="fielddoc">
<p>The callback could not be deregistered, because it had not been registered before. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29ead1cce21da2d8b46e305f9550a7384238"></a>APP_MSG_OUT_OF_MEMORY</em>&nbsp;</td><td class="fielddoc">
<p>The support library did not have sufficient application memory to perform the requested operation. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29eab8679d62177c2bce72ab899c0cf3353a"></a>APP_MSG_CLOSED</em>&nbsp;</td><td class="fielddoc">
<p>App message was closed. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29eaa965e9ce0375fcc796fddaf12e319ee4"></a>APP_MSG_INTERNAL_ERROR</em>&nbsp;</td><td class="fielddoc">
<p>An internal OS error prevented APP_MSG from completing an operation. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga8a213339bca4388cf17c3f4c4b2e11fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define APP_MESSAGE_INBOX_SIZE_MINIMUM&#160;&#160;&#160;124</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>As long as the firmware maintains its current major version, inboxes of this size or smaller will be allowed. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___app_message.html#gad544294c297f3d1941bd94b6b396a24b" title="Programatically determine the inbox size maximum in the current configuration. ">app_message_inbox_size_maximum()</a> </dd>
<dd>
<a class="el" href="group___app_message.html#ga6fe648fbe225cda63583342bb2305187" title="As long as the firmware maintains its current major version, outboxes of this size or smaller will be...">APP_MESSAGE_OUTBOX_SIZE_MINIMUM</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga6fe648fbe225cda63583342bb2305187"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define APP_MESSAGE_OUTBOX_SIZE_MINIMUM&#160;&#160;&#160;636</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>As long as the firmware maintains its current major version, outboxes of this size or smaller will be allowed. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___app_message.html#gaa8161491da4b16dde64be8754cfde815" title="Programatically determine the outbox size maximum in the current configuration. ">app_message_outbox_size_maximum()</a> </dd>
<dd>
<a class="el" href="group___app_message.html#ga8a213339bca4388cf17c3f4c4b2e11fd" title="As long as the firmware maintains its current major version, inboxes of this size or smaller will be ...">APP_MESSAGE_INBOX_SIZE_MINIMUM</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
</div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Nov 20 2014 20:35:18 for Pebble SDK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
